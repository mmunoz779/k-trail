<!DOCTYPE html>
<html lang="en">
<head>
    <title>DayPrompt</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../css/styles.css">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular.min.js"></script>
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script>

</head>


<body ng-app="myApp" ng-controller="WorldData">

<div class="bkgrnd">
    <img src="../assets/snow.gif" alt="snow" class="bksnow" style="width: 100%;" align="center">
    <img src="../assets/dogs.png" alt="dogs" class="dogs">
</div>


<div class="dayText">
<p>Weather: {{state.weather}}</p>
    <p>Pace: {{state.currentPace * state.paceScalar}}</p>
<p>Days passed: {{state.daysPassed}}</p>
<p>Distance Traveled: {{state.distance}} miles</p>

<p>You May:</p>
    <button ng-click='incrementDay(true)'>Start Traveling</button>
    <button ng-click='prospect()'>Mine for Copper</button>
    <button ng-click='inventory()'>Check Inventory</button>
    <button ng-click='Pace()'>Change Pace</button>
    <button ng-click='viewparty()'>Party Status</button>
    <button ng-click='Rest()'>Stop to Rest</button>
</div>
<script>
    var app = angular.module('myApp', []);
    app.controller('WorldData', function ($scope, $http, $window) {
    $scope.state=JSON.parse(sessionStorage.getItem('state'));

    $scope.incrementDay=function(hasTraveled) {
        if (hasTraveled) {
            $scope.state.distance += Math.floor((Math.random() + .25) * ($scope.state.currentPace * $scope.state.paceScalar));
        }
        triggerEvent();
        $scope.state.daysPassed += 1;
        sessionStorage.setItem('state', JSON.stringify($scope.state));
    };

    $scope.triggerEvent=function() {
        //calculate weather

        //distance events
        //random events
    }

    $scope.prospect=function() {
        incrementDay(false);
        sessionStorage.setItem('state', JSON.stringify($scope.state));
        $window.location.href = '/prospecting';
    };
    $scope.Pace=function() {
        sessionStorage.setItem('state', JSON.stringify($scope.state));
        $window.location.href = '/Pace';
    };
    $scope.viewparty=function() {
        sessionStorage.setItem('state', JSON.stringify($scope.state));
        $window.location.href = '/viewparty';
    };
    $scope.Rest=function() {
        incrementDay(false);
        sessionStorage.setItem('state', JSON.stringify($scope.state));
        $window.location.href = '/Rest';
    };
        $scope.inventory = function () {
            sessionStorage.setItem('state', JSON.stringify($scope.state));
            $window.location.href = '/inventory';
        };
    });
</script>
</body>
</html>